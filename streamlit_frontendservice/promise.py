import streamlit as st
import streamlit.components.v1 as components
from collections import Counter
from PIL import Image
import preprocessing
import execute

# root_path = '/Users/junho/Desktop/server/data/'
root_path = './data/'
@st.experimental_singleton
def call_class():
    pre = preprocessing
    sp = execute.SearchPromise()
    vk = execute.VisualizeKeywords()
    km = execute.Kmeans_Visualization()
    chap3_LSA = execute.CategorizePromise()
    ml = execute.ML()
    return pre, sp, vk, km, chap3_LSA, ml
(pre, sp, vk, km, chap3_LSA, ml) = call_class()
@st.experimental_memo
def call_data():
    with open(f'{root_path}lda.html', 'r') as f:
        html_string = f.read()
    with open(f"{root_path}folium.html", 'r', encoding='utf-8') as f:
        html_folium = f.read()
        return html_string, html_folium,
html_string, html_folium = call_data()
tokens = pre.tokens
lines_token = pre.lines_token
promise140 = pre.promise140

candidates = ['ì „ì²´', 'ê¸°í˜¸ 1ë²ˆ', 'ê¸°í˜¸ 2ë²ˆ', 'ê¸°í˜¸ 3ë²ˆ', 'ê¸°í˜¸ 4ë²ˆ', 'ê¸°í˜¸ 5ë²ˆ', 'ê¸°í˜¸ 6ë²ˆ', 'ê¸°í˜¸ 7ë²ˆ',
              'ê¸°í˜¸ 8ë²ˆ', 'ê¸°í˜¸ 9ë²ˆ', 'ê¸°í˜¸ 10ë²ˆ', 'ê¸°í˜¸ 11ë²ˆ', 'ê¸°í˜¸ 12ë²ˆ', 'ê¸°í˜¸ 13ë²ˆ', 'ê¸°í˜¸ 14ë²ˆ']

st.sidebar.header('ë©”ë‰´')
chapter = st.sidebar.selectbox('ì„ íƒ', ['ì‹œì‘', 'í›„ë³´ì ê³µì•½ ë¶„ì„', 'ì£¼ì œ ë¶„ë¥˜', 'í´ëŸ¬ìŠ¤í„°ë§', 'í›„ë³´ì/ê³µì•½ ì¶”ì²œ'])


if chapter == 'ì‹œì‘':
    st.title('ğŸ”¥ ì œ20ëŒ€ ëŒ€ì„  ì •ì±… ê³µì•½ ì‹œê°í™” ğŸ”¥')
    st.markdown('> 2020ë…„ì— ì—´ë¦° ì œ20ëŒ€ ëŒ€í†µë ¹ ì„ ê±° í›„ë³´ì 14ëª…ì˜ ì •ì±… ê³µì•½ì„ ì‹œê°í™”í•˜ì˜€ìŠµë‹ˆë‹¤.')
    st.markdown('#### ğŸ”´ í›„ë³´ì ê³µì•½ ë¶„ì„')
    st.markdown('1. í›„ë³´ìë³„ ì‚¬ìš© ë‹¨ì–´ ë¹„êµ')
    st.markdown('2. ê³µì•½ ìƒê´€ê´€ê³„ ë¹„êµ')
    st.markdown('3. ì£¼ìš”ì •ë‹¹ ì •ë³´')
    st.markdown('#### ğŸŸ  ì£¼ì œ ë¶„ë¥˜')
    st.markdown('1. LSA')
    st.markdown('2. LDA')
    st.markdown('#### ğŸŸ¡ í´ëŸ¬ìŠ¤í„°ë§')
    st.markdown('1. ê³„ì¸µ í´ëŸ¬ìŠ¤í„°ë§')
    st.markdown('2. ë¶€ë¶„ í´ëŸ¬ìŠ¤í„°ë§')
    st.markdown('#### ğŸŸ¢ í›„ë³´ì/ê³µì•½ ì¶”ì²œ')
    st.markdown('1. ë¨¸ì‹ ëŸ¬ë‹')
    st.markdown('2. í´ëŸ¬ìŠ¤í„°ë§')
    st.markdown('3. ì½”ì‚¬ì¸ ìœ ì‚¬ë„')
    st.markdown('### ğŸ‘ˆ ë©”ë‰´ë¥¼ í´ë¦­í•˜ì—¬ ë‹¤ì–‘í•œ ì‹œê°í™” ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”ğŸ˜†')

# ì‹œê°í™” - í›„ë³´ìë³„ ê·¸ë˜í”„, í´ëŸ¬ìŠ¤í„°ë§ë§µ, ì§€ì—­ê³µì•½
elif chapter == 'í›„ë³´ì ê³µì•½ ë¶„ì„':
    st.title('ğŸ”¥ í›„ë³´ì ê³µì•½ ë¶„ì„ ğŸ”¥')
    st.markdown('`ì •ì±…ê³µì•½` `ì§€ì—­ê³µì•½` `ì›Œë“œí´ë¼ìš°ë“œ` `ìƒê´€ê´€ê³„`')
    sub_chapter = st.sidebar.selectbox('ì„ íƒ', ['ì„ íƒ','í›„ë³´ìë³„ ì‚¬ìš© ë‹¨ì–´ ë¹„êµ', 'ê³µì•½ ìƒê´€ê´€ê³„ ë¹„êµ', 'ì£¼ìš” ì •ë‹¹ ì •ë³´'])
    if sub_chapter == 'ì„ íƒ':
        st.markdown('##### ë‹¨ìˆœ ì‹œê°í™”')
        st.markdown('â— ê°€ì¥ ê¸°ë³¸ì ì´ê³  ì§ê´€ì ì¸ ì ‘ê·¼ìœ¼ë¡œ ëŒ€ì„ ê³µì•½ì§‘ì˜ ê³µì•½ ìˆœìœ„ì™€ ì§€ì—­ë³„ ê³µì•½ì„ ì‹œê°í™”í–ˆìŠµë‹ˆë‹¤.')
        st.markdown('â— ìœ ì‚¬ë„ë¥¼ í†µí•´ ê° í›„ë³´ê°€ ì–´ë–¤ ì •ì±…ì„ ì¶”ì§„ í˜¹ì€ íì§€í• ì§€ í‚¤ì›Œë“œë¥¼ ë¶„ì„í•´ ë³´ì•˜ê³ , ê° í›„ë³´ ê°„ ë‹¨ì–´ ì‚¬ìš©ì— ëŒ€í•œ ìƒê´€ê´€ê³„ë¥¼ ì‹œê°í™”í–ˆìŠµë‹ˆë‹¤.')
        st.write('ğŸ‘ˆ  ì„ íƒì„ ëˆŒëŸ¬ ì›í•˜ëŠ” ì •ë³´ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”ğŸ˜†')
    if sub_chapter == 'í›„ë³´ìë³„ ì‚¬ìš© ë‹¨ì–´ ë¹„êµ':
        st.subheader('ğŸ’¡ ë‹¨ì–´ ë¶„ì„')
        st.markdown('ğŸ“Œ ê° í›„ë³´ ê·¸ë˜í”„ì˜ ìœ„ìª½ ë‘ ê°œì˜ ê·¸ë˜í”„ëŠ” ë‹¨ì–´ ìˆ˜ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì•„ë˜ìª½ ë‘ ê°œì˜ ê·¸ë˜í”„ëŠ” word2vecì„ ì´ìš©í–ˆê³ , ê° í›„ë³´ê°€ ì¶”ì§„ í˜¹ì€ íì§€í•˜ê³  ì‹¶ì€ ì •ì±…, ê³µì•½ì´ ë¬´ì—‡ì¸ì§€ í‚¤ì›Œë“œì˜ ìœ ì‚¬ë„ë¥¼ ì´ìš©í•´ ìœ ì¶”í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.')
        st.markdown('#### ğŸ‘‡ ê´€ì‹¬ìˆëŠ” í›„ë³´ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')
        candidate = st.selectbox('', candidates)
        i = candidates.index(candidate)
        if candidate != 'ì „ì²´':
            counts = Counter(tokens[i-1])
            vk.show_graphs(counts, i)
        else:
            counts_for_all = Counter(sum(tokens, []))
            vk.show_graphs(counts_for_all)
    elif sub_chapter == 'ê³µì•½ ìƒê´€ê´€ê³„ ë¹„êµ':
        st.subheader('ğŸ’¡ ê³µì•½ ìƒê´€ê´€ê³„ ë¹„êµ')
        st.markdown('ğŸ“Œ ê° í›„ë³´ì ê³µì•½ì§‘ ì „ì²´ì— ëŒ€í•´ì„œ count ê¸°ë°˜ ìƒìœ„ 500ë‹¨ì–´ì— ëŒ€í•œ ìƒê´€ê³„ìˆ˜ì™€ ê·¸ì— ëŒ€í•œ ë´ë“œë¡œê·¸ë¨ ì…ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ë‹¨ì–´ ë§µí•‘ì—ëŒ€í•œ ìƒê´€ê´€ê³„ì´ë¯€ë¡œ ê°’ì´í´ìˆ˜ë¡ ê°™ì€ ë‹¨ì–´ì˜ ì‚¬ìš©íšŸìˆ˜ì˜ ì°¨ì´ê°€ ì‘ìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ëŒ€ê°ì„ ì„ ì œì™¸í•œ ê°€ì¥ ë†’ì€ ìƒê´€ê³„ìˆ˜ëŠ” 1,3ë²ˆí›„ë³´ì˜ ê°’ì´ê³  1ë²ˆí›„ë³´ì˜ ìƒê´€ê³„ìˆ˜ëŠ” ì „ì²´ì ìœ¼ë¡œ ë†’ìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ì—ì„œ íŠ¹ì§•ì ì¸ ë‘ ê°œì˜ ê·¸ë£¹ì´ ë“œëŸ¬ë‚©ë‹ˆë‹¤.')
        st.markdown('> ğŸˆ 2, 4, 9, 13')
        st.markdown('> ğŸˆ 1, 3, 7, 12')
        vk.corr_map()
    elif sub_chapter == 'ì£¼ìš” ì •ë‹¹ ì •ë³´':
        # ê·¸ë˜í”„ í‘œì‹œ
        st.subheader('ğŸ’¡ ì£¼ì œ ë‹¨ì–´ ë¶„ë¥˜')
        st.markdown('ğŸ“Œ í‚¤ì›Œë“œë¥¼ ì„ ì •í•œ ë’¤, ê° í›„ë³´ìì˜ ì •ì±… ê³µì•½ì— ì–¼ë§ˆë‚˜ ì‚¬ìš©ë˜ì—ˆëŠ”ì§€ ë¹„êµí•´ ë³´ì•˜ìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ê·¸ë˜í”„ëŠ” ê¸°í˜¸ 1, 2, 3, 4ë²ˆ í›„ë³´ìë“¤ì˜ í‚¤ì›Œë“œ ëˆ„ì  ì‚¬ìš© íšŸìˆ˜ì™€ ë¹„ìœ¨ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ê·¸ë˜í”„ë¥¼ í†µí•´ ê° í›„ë³´ìê°€ ì–´ë–¤ í‚¤ì›Œë“œì— ì¤‘ì ì„ ë‘ê³  ìˆëŠ”ì§€ ìœ ì¶”í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.')
        vk.stacked_category()
        st.markdown('___')
        st.subheader('ğŸ’¡ ì§€ì—­ ê³µì•½ ì‚´í´ë³´ê¸°')
        st.markdown('ğŸ“Œ ê¸°í˜¸ 1, 2, 3ë²ˆ í›„ë³´ìë“¤ì˜ ì§€ì—­ ê³µì•½ ìë£Œì§‘ì„ í™œìš©í•˜ì—¬ ì‹œê°í™”í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì§€ì—­ ê³µì•½ ìë£Œì§‘ì„ í™œìš©í•˜ì—¬ ì§€ì—­ë³„ë¡œ í•µì‹¬ ê³µì•½ì„ ë¶„ë¥˜í•œ ë‹¤ìŒ, ì§€ë„ ìœ„ì— í‘œí˜„í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì§€ì—­ë³„ ì¸êµ¬ìˆ˜ë¥¼ ë‚˜íƒ€ëƒ„ìœ¼ë¡œì¨ í•´ë‹¹ ì§€ì—­ì˜ ìœ ê¶Œì ìˆ˜ ì°¨ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')

        components.html(html_folium, width= 800, height= 720)


# ì£¼ì œ ë¶„ë¥˜ - LSA, pyLDAvis
elif chapter == 'ì£¼ì œ ë¶„ë¥˜':
    st.title('ğŸ”¥ ì£¼ì œ ë¶„ë¥˜ ğŸ”¥')
    sub_chapter = st.sidebar.selectbox('ë°©ë²•', ['ì„ íƒ','LSA', 'LDA'])
    st.markdown('`í† í”½ëª¨ë¸ë§` `ì ì¬ì˜ë¯¸` `LSA` `LDA`')
    if sub_chapter == 'ì„ íƒ':
        st.markdown('##### í† í”½ ëª¨ë¸ë§')
        st.markdown('###### â— ë ˆì´ë¸”ì´ ì—†ëŠ” ë°ì´í„° íŠ¹ì„±ìƒ ê³µì•½ë“¤ì´ ë‹¨ì–´ë¥¼ í†µí•´ ì£¼ì œê°€ ì–´ë–»ê²Œ ë¬¶ì´ëŠ”ì§€ ë¶„ì„í•˜ê¸° ìœ„í•´ LSAë¥¼ ì´ìš©í•´ì„œ ì£¼ì œë¥¼ ìœ ì¶”í•˜ì˜€ê³ , ìœ ì¶”í•œ ë ˆì´ë¸”ì„ í†µí•´ ê° í›„ë³´ì˜ ì •ì±…ë¶„í¬ë¥¼ ì‹œê°í™”í–ˆìŠµë‹ˆë‹¤.')
        st.write('ğŸ‘ˆ ì„ íƒì„ ëˆŒëŸ¬ ì›í•˜ëŠ” ì •ë³´ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”ğŸ˜†')
    elif sub_chapter == 'LSA':
        st.subheader('ğŸ’¡ LSA: Latent Semantic Analysis')
        st.markdown('ğŸ“Œ [LSA](https://wikidocs.net/24949)ëŠ” íŠ¹ì‡ê°’ ë¶„í•´(SVD)ë¥¼ í™œìš©í•˜ì—¬ ë¬¸ì„œì— ìˆ¨ì–´ ìˆëŠ” ì£¼ì œë¥¼ ì°¾ì•„ë‚´ëŠ” ê¸°ë²•ì…ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ê° ì •ì±… ê³µì•½ê³¼ ê°€ì¥ ê´€ë ¨ì„±ì´ ë†’ì€ ì£¼ì œë¥¼ í• ë‹¹í•˜ì˜€ìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì—¬ê¸°ì„œ ê´€ë ¨ì„±ì€ ê° ì •ì±… ê³µì•½ì´ ì–´ë–¤ ì ì¬ ì˜ë¯¸êµ°(ì£¼ì œ)ì— ì†í•˜ëŠ” ìš©ì–´ë“¤ì„ ë§ì´ í¬í•¨í•˜ê³  ìˆëŠ”ì§€, ê·¸ ë¹„ì¤‘ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì£¼ì œëŠ” ì£¼ì œë³„ í‚¤ì›Œë“œë¥¼ í™•ì¸í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.')
        st.markdown('> ###### ğŸ”¹ í‰ë“±/ì•ˆì • ğŸ”¹ ì •ì¹˜/í–‰ì •/êµìœ¡ ğŸ”¹ ë¶€ë™ì‚° ğŸ”¹ êµ­ë°©/í†µì¼/ì™¸êµ ğŸ”¹ ê²½ì œ/í™˜ê²½/ê¸°ìˆ  ğŸ”¹ ë¯¸ë˜/ì²­ë…„')
        chap3_LSA.show_graphs_all()
        st.markdown('___')
        st.subheader('ğŸ’¡í›„ë³´ì ë¹„êµ')
        st.markdown('#### ğŸ‘‡ ê´€ì‹¬ìˆëŠ” í›„ë³´ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')
        number = st.select_slider('',
        options=[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14],
        value=4)
        chap3_LSA.show_pie_chart_selective(number)
        chap3_LSA.show_stacked_plot_selective(number)

    else:
        st.subheader('ğŸ’¡ LDA: Latent Dirichlet Allocation')
        st.markdown('ğŸ“Œ [LDA](https://wikidocs.net/30708)ëŠ” LSAì™€ ë¹„ìŠ·í•˜ì§€ë§Œ ë‹¤ë¥¸ì ì€ ì£¼ì œë“¤ì´ ë””ë¦¬í´ë ˆ ë¶„í¬(Dirichlet distribution)ë¥¼ ë”°ë¥¸ë‹¤ê³  ê°€ì •í•˜ì—¬ ì£¼ì œë¥¼ ë¶„ì„í•˜ëŠ” ê¸°ë²•ì…ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì™¼ìª½ ê·¸ë˜í”„ëŠ” í›„ë³´ì˜ ê³µì•½ì„ LDAë¥¼ ì ìš©í•˜ì—¬ ì£¼ì œì— ë”°ë¼ ë¶„ë¥˜í•œ ê²ƒì„ ì‹œê°í™”í•œ ê²°ê³¼ì…ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì˜¤ë¥¸ìª½ ë°” ê·¸ë˜í”„ëŠ” ê° êµ°ì§‘ì— ë”°ë¼ íŠ¹ì§•ì ì¸ ë‹¨ì–´ì™€ ë¹ˆë„ìˆ˜ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì˜¤ë¥¸ìª½ ìœ„ì˜ Î»ê°’ì´ 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê·¸ êµ°ì§‘ë§Œì˜ íŠ¹ì§•ì ì¸ ë‹¨ì–´ê°€ ë‚˜íƒ€ë‚˜ê³ , 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì „ì²´ ê³µì•½ì§‘ì—ì„œ ê°€ì¥ ë§ì€ ë¹ˆë„ìˆ˜ë¥¼ ì°¨ì§€í•œ ë‹¨ì–´ê°€ í•´ë‹¹ êµ°ì§‘ì—ì„œ ì°¨ì§€í•˜ëŠ” ì •ë„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì™¼ìª½ ìœ„ì— ìˆ«ìë¥¼ ì…ë ¥í•˜ë©´ í•´ë‹¹ êµ°ì§‘ì— ëŒ€í•œ ì •ë³´ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. LDAë¥¼ ì´ìš©í•œ ì‚¬í›„ ë¶„ì„ ê²°ê³¼ ìµœì ì˜ êµ°ì§‘ ê°œìˆ˜ëŠ” 7ê°œì´ë©°, ê° êµ°ì§‘ì— ëŒ€í•œ ì£¼ì œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.')
        st.markdown('> ###### 1ï¸âƒ£ í‰í™”/ì•ˆë³´  2ï¸âƒ£ ê³ ìš©/ì¼ìë¦¬  3ï¸âƒ£ ì£¼íƒ/ë¶€ë™ì‚°  4ï¸âƒ£ ì„ ê±°  5ï¸âƒ£ ë²•ë¥ /ì œë„  6ï¸âƒ£ ì‚¬íšŒë³´ì¥ì„œë¹„ìŠ¤  7ï¸âƒ£ ì‚°ì—…')
        components.html(html_string,width=1300,height=800)

# í´ëŸ¬ìŠ¤í„°ë§
elif chapter == 'í´ëŸ¬ìŠ¤í„°ë§':
    st.title('ğŸ”¥ í´ëŸ¬ìŠ¤í„°ë§ ğŸ”¥')
    st.markdown('`ë´ë“œë¡œê·¸ë¨` `K-means` `ì‹¤ë£¨ì—£ ê³„ìˆ˜` `ì—˜ë³´ìš° ë°©ë²•`')
    sub_chapter = st.sidebar.selectbox('ë°©ë²•', ['ì„ íƒ','ê³„ì¸µ í´ëŸ¬ìŠ¤í„°ë§','êµ°ì§‘ ê°¯ìˆ˜ í‰ê°€', 'ë¶€ë¶„ í´ëŸ¬ìŠ¤í„°ë§'])
    if sub_chapter == 'ì„ íƒ':
        st.markdown('##### êµ°ì§‘ ë¶„ì„')
        st.markdown('###### â— í›„ë³´ë“¤ì˜ ê³µì•½ì„ ë ˆì´ë¸”ì´ ì—†ëŠ” í˜•íƒœ ê·¸ëŒ€ë¡œ ë¶„ì„í•˜ê¸° ìœ„í•´ ë¹„ì§€ë„í•™ìŠµ í´ëŸ¬ìŠ¤í„°ë§ì¸ [K-means](https://ko.wikipedia.org/wiki/K-í‰ê· _ì•Œê³ ë¦¬ì¦˜)ë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ ì‚¬í•œ í›„ë³´ë¼ë¦¬ êµ°ì§‘ì„ ë‚˜ëˆ„ì–´ í›„ë³´ ì§‘ë‹¨ì„ í˜•ì„±í•œ ê²°ê³¼ë¥¼ ì‹œê°í™”í–ˆìŠµë‹ˆë‹¤.')
        st.write('ğŸ‘ˆ ì„ íƒì„ ëˆŒëŸ¬ ì›í•˜ëŠ” ì •ë³´ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”ğŸ˜†')
    elif sub_chapter == 'ê³„ì¸µ í´ëŸ¬ìŠ¤í„°ë§':
        st.subheader('ğŸ’¡ ê³„ì¸µ í´ëŸ¬ìŠ¤í„°ë§')
        st.markdown('ğŸ“Œ êµ°ì§‘ì˜ ê°œìˆ˜ë¥¼ ê³„ì¸µì„ ë§Œë“¤ì–´ì„œ êµ°ì§‘ì„ ë¶„ë¥˜í•˜ëŠ” ë°©ë²•ì„ ê³„ì¸µ í´ëŸ¬ìŠ¤í„°ë§ì´ë¼ í•©ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ scipyë¥¼ ì´ìš©í–ˆê³ , ë´ë“œë¡œê·¸ë¨ì„ ê·¸ë˜í”„ ìœ„ì— ì„ì˜ì˜ ì ì„ ì„ ê·¸ì–´ 4ê°œì˜ í´ëŸ¬ìŠ¤í„°ë¡œ êµ¬ë¶„í•´ë³´ì•˜ìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì…ë ¥ ë°ì´í„°ëŠ” ê³µì•½ ì œëª©ì„ pcaë¡œ ì°¨ì› ì¶•ì†Œí•œ ê°’ì´ê³ , ì™€ë“œì—°ê²°ë²•ì„ ì´ìš©í•œ ë´ë“œë¡œê·¸ë¨ ì…ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ê·¸ ê²°ê³¼, í›„ë³´ìë“¤ì˜ ì •ì±… ê³µì•½ì€ ë‹¤ìŒê³¼ ê°™ì´ 4ê°œì˜ êµ°ì§‘ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')
        st.markdown('> ğŸˆ 1')
        st.markdown('> ğŸˆ 2, 3, 5, 7, 12')
        st.markdown('> ğŸˆ 4, 8, 9, 10, 11, 13, 14')
        st.markdown('> ğŸˆ 6')
        st.pyplot(km.show_dendrogram())
    elif sub_chapter == 'êµ°ì§‘ ê°¯ìˆ˜ í‰ê°€':
        st.subheader('ğŸ’¡ êµ°ì§‘ ê°¯ìˆ˜ í‰ê°€ ')
        st.markdown('ğŸ“Œ êµ°ì§‘ ê°œìˆ˜ Kë¥¼ ì •í•˜ëŠ” ë‹¤ì–‘í•œ í‰ê°€ ë°©ë²•ì´ ìˆëŠ”ë°, ì €í¬ëŠ” ì‹¤ë£¨ì—£ ë°©ë²•ê³¼ ì—˜ë³´ìš° ë°©ë²•ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì‹¤ë£¨ì—£ ê³„ìˆ˜ê°€ 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ë‘ êµ°ì§‘ ê°„ ê±°ë¦¬ê°€ ë©€ì–´ êµ°ì§‘ì´ ì˜ ë¶„ë¥˜ëœ ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì‹¤ë£¨ì—£ ì‹œê°í™”ëŠ” ìƒ‰ìƒì´ ë“¤ì–´ê°„ ë§‰ëŒ€ê°€ ê° êµ°ì§‘ì„ ì˜ë¯¸í•˜ë©°, ë¹¨ê°„ìƒ‰ ì ì„ ì€ ìœ„ì—ì„œ êµ¬í•œ ê° êµ°ì§‘ ê°¯ìˆ˜ì˜ ì‹¤ë£¨ì—£ ê³„ìˆ˜ì…ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì´ êµ°ì§‘ë“¤ì´ ë¹¨ê°„ ì ì„ ì¸ í‰ê·  ì‹¤ë£¨ì—£ ê³„ìˆ˜ë¥¼ ë§ì´ ë„˜ì„ìˆ˜ë¡ ê· ì¼í•˜ê²Œ ì˜ ë¶„ë¥˜ëœ ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ ì—˜ë³´ìš° ë°©ë²•ì€ ì˜¤ì°¨ë“¤ì˜ ê±°ë¦¬(SSE)ë¥¼ ì´ìš©í•˜ì—¬ ìµœì ì˜ êµ°ì§‘ ê°œìˆ˜ë¥¼ ì •í•©ë‹ˆë‹¤. ê²€ì€ìƒ‰ ì ì„ ì˜ ìœ„ì¹˜ê°€ ìµœì  êµ°ì§‘ ê°¯ìˆ˜ì…ë‹ˆë‹¤.')
        st.markdown('> ##### ì•„ë˜ì˜ ê²°ê³¼ë¥¼ ì¢…í•©í•´ì„œ, êµ°ì§‘ ê°¯ìˆ˜ë¥¼ 4ë¡œ ì„ íƒí–ˆìŠµë‹ˆë‹¤.')
        km.sil_score()
        st.pyplot(km.silhouette_visualizer())
        st.pyplot(km.kelbow_visualizer())
    elif sub_chapter == 'ë¶€ë¶„ í´ëŸ¬ìŠ¤í„°ë§':
        st.subheader('ğŸ’¡ ë¶€ë¶„ í´ëŸ¬ìŠ¤í„°ë§')
        st.markdown('ğŸ“Œ ì—¬ê¸°ì„œ ì œê³µí•˜ëŠ” [UMAP](https://arxiv.org/abs/1802.03426) ì‹œê°í™”ëŠ” í›„ë³´ì˜ ê³µì•½ ì œëª© ë¬¸ì„œë¥¼ ìœ„ì¹˜ ë²¡í„°ê°’ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” Doc2Vecë°©ì‹ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ í¼ì§€ ì´ë¡ ê³¼ ìœ„ìƒìˆ˜í•™ì„ ì´ìš©í•˜ì—¬ ê³ ì°¨ì› ë°ì´í„°ì— ì í•©í•œ UMAPë°©ë²•ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.')
        st.markdown('ğŸ“Œ UMAPì€ ë¬¸ì„œì˜ ìœ„ì¹˜ê°€ í™•ë¥ ì ìœ¼ë¡œ ê°€ì¥ ê°€ê¹Œìš´ í›„ë³´ë¼ë¦¬ êµ°ì§‘í™”ëœ ê²°ê³¼ë¥¼ ì œê³µí•©ë‹ˆë‹¤.')
        st.markdown('#### ğŸ‘‡ êµ°ì§‘ ê°¯ìˆ˜ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')
        number = st.select_slider('',
        options=[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14],
        value=4)
        st.markdown('> ì €í¬ì˜ ë¶„ì„ ê²°ê³¼ ìµœì ì˜ êµ°ì§‘ ê°œìˆ˜ëŠ” 4 ì…ë‹ˆë‹¤.')
        @st.experimental_memo
        def call_umap(root_path, number):
            umap_image = Image.open(f'{root_path}umap/umap_{number}.png')
            return umap_image
        st.image(call_umap(root_path, number))

# ì¶”ì²œ
elif chapter == 'í›„ë³´ì/ê³µì•½ ì¶”ì²œ':
    st.title('ğŸ”¥ í›„ë³´ì/ê³µì•½ ì¶”ì²œ ğŸ”¥')
    st.markdown('`ì¶”ì²œì‹œìŠ¤í…œ` `ë¨¸ì‹ ëŸ¬ë‹` `í´ëŸ¬ìŠ¤í„°ë§` `ì½”ì‚¬ì¸ìœ ì‚¬ë„`')
    sub_chapter = st.sidebar.selectbox('ë°©ë²•', ['ì„ íƒ','ë¨¸ì‹ ëŸ¬ë‹', 'í´ëŸ¬ìŠ¤í„°ë§', 'ì½”ì‚¬ì¸ ìœ ì‚¬ë„'])
    if sub_chapter == 'ì„ íƒ':
        st.markdown('##### ì¶”ì²œ ì‹œìŠ¤í…œ')
        st.markdown('###### â— í›„ë³´ ì¶”ì²œì€ ì§€ë„í•™ìŠµê³¼ ë¹„ì§€ë„í•™ìŠµ ê·¸ë¦¬ê³  ìœ ì‚¬ë„ ë¶„ì„ê¸°ë²•ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì…ë ¥ê°’ì„ ë°›ê³  ì…ë ¥ê°’ì— ê°€ì¥ ì í•©í•œ ê³µì•½ì§‘ì„ ì¶”ì²œí•©ë‹ˆë‹¤.')
        st.write('ğŸ‘ˆ ì„ íƒì„ ëˆŒëŸ¬ ì›í•˜ëŠ” ì •ë³´ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”ğŸ˜†')

    elif sub_chapter == 'ë¨¸ì‹ ëŸ¬ë‹':
        st.subheader('ğŸ’¡ ë¨¸ì‹ ëŸ¬ë‹ì„ ì´ìš©í•œ í›„ë³´ì ì¶”ì²œ')
        st.markdown('#### ğŸ‘‡ ì‚¬ìš©ìì˜ ê´€ì‹¬ì‚¬ë¥¼ ì…ë ¥í•˜ë©´ ê·¸ ê´€ì‹¬ì‚¬ì™€ ì¼ì¹˜í•˜ëŠ” í›„ë³´ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.')
        target = st.text_input('', value='ì¸ê³µ ì§€ëŠ¥')
        if target:
            for i in ml.pred(target):
                if i == 'ì ìš©ëœ í‚¤ì›Œë“œê°€ ì—†ìœ¼ë¯€ë¡œ ë‹¤ì‹œ ê²€ìƒ‰í•´ ì£¼ì„¸ìš”.':
                    st.warning('ì ìš©ëœ í‚¤ì›Œë“œê°€ ì—†ìŠµë‹ˆë‹¤ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.ğŸ˜…')
                else:
                    st.success('ê²€ìƒ‰ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.')
                    st.write('ì¶”ì²œëœ ê³µì•½ì§‘ì€', i, 'ì…ë‹ˆë‹¤.ğŸ˜†')

    elif sub_chapter == 'í´ëŸ¬ìŠ¤í„°ë§':
        st.subheader('ğŸ’¡ í´ëŸ¬ìŠ¤í„°ë§ì„ ì´ìš©í•œ í›„ë³´ì ì¶”ì²œ')
        st.markdown('#### ğŸ‘‡ ì‚¬ìš©ìì˜ ê´€ì‹¬ì‚¬ë¥¼ ì…ë ¥í•˜ë©´ ì‚¬ìš©ìì™€ ë¹„ìŠ·í•œ í›„ë³´ ì§‘ë‹¨ì„ ì¶”ì²œí•´ì¤ë‹ˆë‹¤.')
        user_input = st.text_input('', value = 'ì €ëŠ” ì·¨ì—…ì„ ì¤€ë¹„í•˜ê³  ìˆëŠ” í•™ìƒì…ë‹ˆë‹¤. í•™ìƒë“¤ì´ ì¼ìë¦¬ë¥¼ êµ¬í•  ìˆ˜ ìˆë„ë¡ ë‹¤ì–‘í•œ êµìœ¡ ê¸°íšŒì™€ ì§€ì› ì •ì±…ì— ê´€ì‹¬ì´ ë§ìŠµë‹ˆë‹¤.')
        st.markdown('#### ğŸ‘‡ êµ°ì§‘ ê°¯ìˆ˜ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')
        number = st.select_slider('',
        options=[2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14],
        value=4)
        @st.experimental_singleton
        def call_ku(user_input):
            ku = execute.User_Kmeans(user_input)
            return ku
        ku = call_ku(user_input)
        st.set_option('deprecation.showPyplotGlobalUse', False)
        st.pyplot(ku.UMAP_show(number))

    elif sub_chapter == 'ì½”ì‚¬ì¸ ìœ ì‚¬ë„':
        st.subheader('ğŸ’¡ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ì´ìš©í•œ ê³µì•½ ì¶”ì²œ')
        st.markdown('#### ğŸ‘‡ [ì½”ì‚¬ì¸ ìœ ì‚¬ë„](https://ko.wikipedia.org/wiki/%EC%BD%94%EC%82%AC%EC%9D%B8_%EC%9C%A0%EC%82%AC%EB%8F%84)ë¥¼ ì´ìš©í•˜ì—¬ ê´€ë ¨ ì •ì±… ê³µì•½ì„ ì¶”ì²œí•´ ë“œë¦½ë‹ˆë‹¤.')
        user_input = st.text_input('', value = 'ex) í­ë ¥ê³¼ ì°¨ë³„ ì—†ëŠ” ì„¸ìƒì„ ë§Œë“¤ì–´ ì£¼ì„¸ìš”!!')
        sp.show_similar_promise(user_input)